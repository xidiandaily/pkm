个人知识管理系统实现
作者:chiyl
Last update:%%mtime(%c)

%!includeconf:config.t2t

---------------------
%!include: file_head.t2t
---------------------
%!include: change_log.t2t

+介绍+
就像首页所讲的那样，这个网站保存的是我的工作、学习笔记，计算机内容，整个项目是使用git来进行管理的。既然将个人的知识管理提升到系统的概念。那么我希望这个系统能够实现下面这几个功能：
  - 便于记录（从文档的写作实践来看，很多事情都是做时候没有时间记，做好了之后没动力写。**这个时候，文档系统如果做得便捷，最大限度减少记录的阻力。这个很重要**）
  - 便于自动化管理（谁都不愿意辛辛苦苦写的文档没有很好的管理，比如说**备份**、**版本管理**、**更新以及发布**...这些都是很重要的因素）
  - 便于分享，查阅（自己查找文档要方便，能够支持各种快速的查阅方式）
  - 权限管理（不便于公布的内容只能自己查看）


 
+工具+
|| 工具 | 功能 ||
| cygwin | 基本工作环境 |
| git | 文章版本管理 |
| perl | 文章目录生成，html自动化生成 |
| txt2tags | 文章编写语言，是一个轻量标记语言。可以将符合语法规则的文章转成多种格式 **html**、**wiki**。。。 |
| iconv | 不同编码之间的转换(utf-8 -> cp936) |
| python | txt2tags 的工作环境 |

+系统实现+
  版本管理使用git，这样可以提供完善的版本管理功能。文章源文件 t2t 可以一开放项目的方式存放到 githost 里面。html格式的文章可以放到网站上，这样可以满足随时随地查阅的需求（使用手机浏览器） :-).
  cygwin是个linux模拟器，使用其可以有足够多的脚本来实现系统的自动化管理。

+文章编写+
   - 目录: 采用时间+名称的方式进行命名。为了便于git管理，使用英文名称。
   - 编写：使用txt2tags编写
   - 文章的结构:@@
       - 一般是顶行为文章的名称（生成首页目录时候也是抓取这个名称放到首页去） 
       - 第二行是作者
       - 第三行是文章生成时间。生成时间是指由 t2t 文件转成html的时间，并不是文章的修改时间。
       - 文章的修改时间、修改内容、修改时所在的版本均在文章正文头部的表格中列出。修改内容时间等信息是抓取git里面的log内容生成。
       - 文章头部和尾部都有返回到首页的链接（方便在网站上浏览）
       - 目前敏感内容不做记录（**使用其他的工具记录**）

 
+文章分享+
   目前html版放在个人网站上。

+系统的自动化管理+
   + 版本管理@@
     这个由git来进行，注意文章名称不应该用中文，目录路径也不应该有路径。这是从兼容性上来考虑的，之前试过直接使用中文文章名称，结果git在升级了若干个版本之后，更改了中文的编码方式，这下之前的文件修改记录都丢失了，还好项目时间不长，可以重新开始。...@@
     git的远端服务器放在githost上，有需要就备份上去。@@
   + 文章目录的自动生成@@
     文章编写完成之后，添加至版本管理/修改后上传版本管理。然后直接在Cygwin中运行根目录的 build.sh，即可生成所有的文章的html格式文件，再将其上传至网站即可。
   + 原理@@
     自动生成的功能从功能上划分可以分为:文章修改记录的抓取、自动生成html，目录文件的生成、首页的自动生成。
     - 文章修改记录的抓取@@
     文章的修改记录的抓取是由脚本**log2html.sh**完成，他从标准输入接受一个文件名称，调用git log来输出文件的修改记录。其中 git log的记录格式是可以配置的，使用选项 --format=<string> 选项来生成符合格式的log，并将其存放在 change_log.t2t 中，在接下来的 txt2tags 生成该文件的html格式时，这个文件会被包含在文章的头部。
     值得注意的是，git log 输出的格式是和git中存储的格式是一样的，为 utf-8 格式，这样输出的log格式也是utf-8，但是我们写文章的编码时cp936，因此需要经过转换。我们这里使用了 **iconv** 这个工具来转换，从标准输入得到 utf-8 格式字符串，将其转成 cp936，再将其送进change_log.t2t。
     - 文章目录的生成@@
     所有**pkm目录**下的文章（都是以日期开头）生成文件目录 file_list.t2t ，这个文件再在生成首页时候使用。这个生成工作是由 update_file_list.pl 来实现的。
     目录中每个标题下的链接都是相对地址，目的是减少跳转时间。
     目录中文章的排序是根据文章名称来排序（以编写日期为序，最新编写的文章在最上面）
@@
@@



+其他+

（无）

---------------------
%!include: file_head.t2t
